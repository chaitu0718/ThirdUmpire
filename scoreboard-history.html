<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scoreboard History</title>
<style>
  body {
    background: #222;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    font-family: Arial, sans-serif;
    color: white;
  }

  .app { display: flex; flex-direction: column; align-items: center; }
  .title { margin-bottom: 10px; font-size: 1.5em; letter-spacing: 1px; }

  .screen {
    background: #333;
    aspect-ratio: 9 / 16;
    width: 360px;
    border-radius: 20px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    border: 3px solid #555;
    padding: 10px;
    box-sizing: border-box;
  }

  .lower-half {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 15px;
    border-top: 2px solid #444;
  }

  .heading { font-size: 1.1em; font-weight: bold; text-transform: uppercase; margin-bottom: 15px; }

  .history-container {
    width: 100%;
    flex: 1;
    overflow-y: auto;
    background: #444;
    padding: 10px;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    scroll-behavior: smooth;
    max-height: 320px; /* ✅ Fixed scrollable area inside screen */
  }

  .history-item {
    background: #555;
    padding: 8px;
    border-radius: 6px;
    font-size: 0.9em;
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .history-item span { font-size: 0.85em; color: #ccc; }

  /* ✅ Dot ball styling */
  .dot-ball {
    color: #ccc;
    font-weight: bold;
  }

  .button-container {
    margin-top: 10px;
    display: flex;
    justify-content: space-between;
    width: 90%;
    gap: 10px;
  }

  .btn {
    flex: 1;
    padding: 8px 0;
    background: #ff4444;
    color: white;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.2s;
    text-align: center;
  }

  .btn:hover { background: #ff6666; }
  .btn.back { background: #44aaff; }
  .btn.back:hover { background: #66cfff; }
</style>
</head>
<body>

<div class="app">
  <h1 class="title">Scoreboard History</h1>
  <div class="screen">
    <div class="lower-half">
      <div class="heading">Scoreboard History</div>
      <div class="history-container" id="history-container"></div>
      <div class="button-container">
        <button class="btn back" id="back-btn">Back</button>
        <button class="btn" id="clear-history">Clear History</button>
      </div>
    </div>
  </div>
</div>

<script>
const historyContainer = document.getElementById('history-container');
const clearButton = document.getElementById('clear-history');
const backButton = document.getElementById('back-btn');

// Load history
function loadHistory() {
  historyContainer.innerHTML = '';
  const history = JSON.parse(localStorage.getItem('scoreHistory') || '[]');
  if (history.length === 0) {
    const noHistory = document.createElement('div');
    noHistory.textContent = 'No overs recorded yet.';
    noHistory.style.color = '#ccc';
    noHistory.style.textAlign = 'center';
    historyContainer.appendChild(noHistory);
    return;
  }

  history.forEach((over, i) => {
    let overScore = 0;
    over.balls.forEach(ball => {
      const val = parseInt(ball);
      if (!isNaN(val)) overScore += val;
    });

    // ✅ Replace dot balls with a gray dot (•)
    const formattedBalls = over.balls.map(ball => {
      return (ball === '.') 
        ? '<span class="dot-ball">•</span>' 
        : ball;
    });

    const item = document.createElement('div');
    item.className = 'history-item';
    item.innerHTML = `<strong>Over ${i+1}</strong>
                      <span>Balls: ${formattedBalls.join(', ')}</span>
                      <span>Score: ${overScore}</span>
                      <span>Wickets: ${over.wickets}</span>
                      <span>Overs: ${over.overs}</span>`;
    historyContainer.appendChild(item);
  });

  // ✅ Automatically scroll to bottom if overflow occurs
  requestAnimationFrame(() => {
    historyContainer.scrollTop = historyContainer.scrollHeight;
  });
}

loadHistory();

// Clear history button
clearButton.addEventListener('click', () => {
  if (confirm('Are you sure you want to clear all history?')) {
    localStorage.removeItem('scoreHistory');
    localStorage.removeItem('currentMatch'); // Reset current match as well
    loadHistory();
    alert('History cleared. Returning to scoreboard will reset all scores.');
  }
});

// Back button
backButton.addEventListener('click', () => {
  window.location.href = 'index.html';
});
</script>

</body>
</html>
